<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"util_reservation.js.html":{"id":"util_reservation.js.html","title":"Source: util/reservation.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/reservation.js &quot;use strict&quot;; var __awaiter = (this &amp;&amp; this.__awaiter) || function (thisArg, _arguments, P, generator) { return new (P || (P = Promise))(function (resolve, reject) { function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } } function rejected(value) { try { step(generator[&quot;throw&quot;](value)); } catch (e) { reject(e); } } function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); } step((generator = generator.apply(thisArg, _arguments || [])).next()); }); }; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); // tslint:disable:no-magic-numbers /** * 座席予約ユーティリティ */ const createDebug = require(&quot;debug&quot;); const moment = require(&quot;moment&quot;); const sequence_1 = require(&quot;../model/mongoose/sequence&quot;); const ReservationUtil = require(&quot;./reservation&quot;); const debug = createDebug('chever-domain:*'); const DEFAULT_RADIX = 10; /** * 仮予約 */ exports.STATUS_TEMPORARY = 'TEMPORARY'; /** * CHEVRE確保上の仮予約 */ exports.STATUS_TEMPORARY_ON_KEPT_BY_CHEVRE = 'TEMPORARY_ON_KEPT_BY_CHEVRE'; /** * 決済待ち */ exports.STATUS_WAITING_SETTLEMENT = 'WAITING_SETTLEMENT'; /** * ペイデザイン決済待ち */ exports.STATUS_WAITING_SETTLEMENT_PAY_DESIGN = 'WAITING_SETTLEMENT_PAY_DESIGN'; /** * CHEVRE確保 */ exports.STATUS_KEPT_BY_CHEVRE = 'KEPT_BY_CHEVRE'; /** * メルマガ会員保留 */ exports.STATUS_KEPT_BY_MEMBER = 'KEPT_BY_MEMBER'; /** * 予約確定 */ exports.STATUS_RESERVED = 'RESERVED'; /** * 一般 */ exports.PURCHASER_GROUP_CUSTOMER = '01'; /** * メルマガ会員先行 */ exports.PURCHASER_GROUP_MEMBER = '02'; /** * 内部関係者 */ exports.PURCHASER_GROUP_STAFF = '04'; /** * 窓口 */ exports.PURCHASER_GROUP_WINDOW = '06'; /** * MX4D追加料金 */ exports.CHARGE_MX4D = 1200; /** * コンビニ決済手数料 */ exports.CHARGE_CVS = 150; exports.CHECK_DIGIT_WEIGHTS = [2, 6, 3, 7, 5, 4, 2]; exports.SORT_TYPES_PAYMENT_NO = [ [5, 0, 2, 3, 6, 1, 4], [6, 1, 0, 4, 3, 5, 2], [3, 2, 4, 1, 0, 5, 6], [0, 1, 3, 2, 6, 5, 4], [2, 5, 0, 6, 1, 4, 3], [1, 5, 4, 0, 3, 2, 6], [2, 3, 6, 5, 1, 0, 4], [4, 0, 5, 6, 2, 1, 3], [6, 4, 5, 2, 3, 0, 1], [2, 4, 0, 3, 5, 6, 1] ]; /** * 採番対象名 */ exports.SEQUENCE_TARGET = 'payment_no'; exports.MAX_LENGTH_OF_SEQUENCE_NO = 7; /** * 購入管理番号生成 */ function publishPaymentNo(date) { return __awaiter(this, void 0, void 0, function* () { if (!/\\d{8}/.test(date)) { throw new Error('invalid date'); } const sequence = yield sequence_1.default.findOneAndUpdate({ target: exports.SEQUENCE_TARGET, date: date }, { $inc: { no: 1 } }, { upsert: true, new: true }).exec(); const no = sequence.get('no'); debug('no:', no); // 9桁になるように0で埋める const source = pad(no.toString(), exports.MAX_LENGTH_OF_SEQUENCE_NO, '0'); const checKDigit = ReservationUtil.getCheckDigit(source); const checKDigit2 = ReservationUtil.getCheckDigit2(source); debug('source:', source, 'checKDigit:', checKDigit, 'checKDigit2:', checKDigit2); // sortTypes[checkDigit]で並べ替える const sortType = ReservationUtil.SORT_TYPES_PAYMENT_NO[checKDigit]; debug('sortType:', sortType); return checKDigit2.toString() + sortType.map((index) =&gt; source.substr(index, 1)).join('') + checKDigit.toString(); }); } exports.publishPaymentNo = publishPaymentNo; /** * 頭を指定文字列で埋める * @param input 元の文字列 * @param length 最終的な文字列の長さ * @param padString 埋める文字列 * @returns 結果文字列 */ function pad(input, length, padString) { return (padString.repeat(length) + input).slice(-length); } /** * チェックディジットを求める */ function getCheckDigit(source) { if (source.length !== exports.MAX_LENGTH_OF_SEQUENCE_NO) { throw new Error(`source length must be ${exports.MAX_LENGTH_OF_SEQUENCE_NO}`); } let sum = 0; source.split('').reverse().forEach((digitNumber, index) =&gt; { sum += parseInt(digitNumber, DEFAULT_RADIX) * ReservationUtil.CHECK_DIGIT_WEIGHTS[index]; }); const checkDigit = 11 - (sum % 11); // 2桁の場合0、1桁であればそのまま(必ず1桁になるように) return (checkDigit &gt;= 10) ? 0 : checkDigit; } exports.getCheckDigit = getCheckDigit; /** * チェックディジットを求める2 */ function getCheckDigit2(source) { if (source.length !== exports.MAX_LENGTH_OF_SEQUENCE_NO) { throw new Error(`source length must be ${exports.MAX_LENGTH_OF_SEQUENCE_NO}`); } let sum = 0; source.split('').reverse().forEach((digitNumber, index) =&gt; { sum += parseInt(digitNumber, DEFAULT_RADIX) * ReservationUtil.CHECK_DIGIT_WEIGHTS[index]; }); return 9 - (sum % 9); } exports.getCheckDigit2 = getCheckDigit2; /** * 購入番号の有効性をチェックする */ function isValidPaymentNo(paymentNo) { if (paymentNo.length !== exports.MAX_LENGTH_OF_SEQUENCE_NO + 2) { return false; } const sequeceNo = ReservationUtil.decodePaymentNo(paymentNo); const checkDigit = ReservationUtil.getCheckDigit(pad(sequeceNo.toString(), exports.MAX_LENGTH_OF_SEQUENCE_NO, '0')); const checkDigit2 = ReservationUtil.getCheckDigit2(pad(sequeceNo.toString(), exports.MAX_LENGTH_OF_SEQUENCE_NO, '0')); debug(paymentNo, sequeceNo, checkDigit, checkDigit2); return (parseInt(paymentNo.substr(-1), DEFAULT_RADIX) === checkDigit &amp;&amp; parseInt(paymentNo.substr(0, 1), DEFAULT_RADIX) === checkDigit2); } exports.isValidPaymentNo = isValidPaymentNo; /** * 購入番号をデコードする * @param paymentNo 購入番号 * @returns 連番 */ function decodePaymentNo(paymentNo) { // 購入番号から、並び替えられた連番を取り出し、元の連番に並び替えなおす const checkDigit = parseInt(paymentNo.substr(-1), DEFAULT_RADIX); const strs = paymentNo.substr(1, paymentNo.length - 2); const sortType = ReservationUtil.SORT_TYPES_PAYMENT_NO[checkDigit]; debug(checkDigit, strs, sortType); const source = Array.from(Array(exports.MAX_LENGTH_OF_SEQUENCE_NO)).reduce((a, __, weightNumber) =&gt; a + strs.substr(sortType.indexOf(weightNumber), 1), ''); return Number(source); } exports.decodePaymentNo = decodePaymentNo; /** * GMOオーダーIDを生成する * @param performanceDay パフォーマンス上映日(8桁) * @param paymentNo 購入番号(9桁) * @param serialNumber 連番(2桁) */ function createGMOOrderId(performanceDay, paymentNo, serialNumber) { // todo 引数の文字数などチェック return `${moment().format('YYYYMMDD')}${performanceDay}${paymentNo}${serialNumber}`; } exports.createGMOOrderId = createGMOOrderId; /** * GMOオーダーIDをパースする * @param orderId オーダーID */ function parseGMOOrderId(orderId) { // todo 引数の文字数などチェック return { purchasedAt: orderId.substr(0, 8), performanceDay: orderId.substr(8, 8), paymentNo: orderId.substr(16, 9), serialNumber: orderId.substr(25) }; } exports.parseGMOOrderId = parseGMOOrderId; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_performanceStatuses.js.html":{"id":"model_performanceStatuses.js.html","title":"Source: model/performanceStatuses.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/performanceStatuses.js &quot;use strict&quot;; var __awaiter = (this &amp;&amp; this.__awaiter) || function (thisArg, _arguments, P, generator) { return new (P || (P = Promise))(function (resolve, reject) { function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } } function rejected(value) { try { step(generator[&quot;throw&quot;](value)); } catch (e) { reject(e); } } function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); } step((generator = generator.apply(thisArg, _arguments || [])).next()); }); }; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * パフォーマンス情報モデル */ const redis = require(&quot;redis&quot;); const PerformanceUtil = require(&quot;../util/performance&quot;); if (process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_PORT === undefined) { console.error('process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_PORT required'); } if (process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_HOST === undefined) { console.error('process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_HOST required'); } let redisClient; try { redisClient = redis.createClient(Number(process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_PORT), process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_HOST, { password: process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_KEY, tls: { servername: process.env.CHEVRE_PERFORMANCE_STATUSES_REDIS_HOST }, return_buffers: true }); } catch (error) { console.error(error); } const REDIS_KEY = 'CHEVRESeatStatusesByPerformanceId'; const EXPIRATION_SECONDS = 3600; /** * パフォーマンス情報 */ class PerformanceStatuses { /** * パフォーマンスIDから空席ステータスを取得する */ getStatus(id) { return (this.id !== undefined) ? this[id] : PerformanceUtil.SEAT_STATUS_A; } /** * パフォーマンスIDの空席ステータスをセットする */ setStatus(id, status) { this[id] = status; } } exports.PerformanceStatuses = PerformanceStatuses; /** * パフォーマンス情報を新規作成する */ function create() { return new PerformanceStatuses(); } exports.create = create; /** * ストレージに保管する */ function store(performanceStatuses) { return __awaiter(this, void 0, void 0, function* () { return new Promise((resolve, reject) =&gt; { redisClient.setex(REDIS_KEY, EXPIRATION_SECONDS, JSON.stringify(performanceStatuses), (err) =&gt; { if (err instanceof Error) { reject(err); } else { resolve(); } }); }); }); } exports.store = store; /** * ストレージから検索する */ function find() { return __awaiter(this, void 0, void 0, function* () { return new Promise((resolve, reject) =&gt; { redisClient.get(REDIS_KEY, (err, reply) =&gt; { if (err instanceof Error) { reject(err); return; } if (reply === null) { reject(new Error('not found')); return; } const performanceStatuses = new PerformanceStatuses(); try { const performanceStatusesModelInRedis = JSON.parse(reply.toString()); Object.keys(performanceStatusesModelInRedis).forEach((propertyName) =&gt; { performanceStatuses.setStatus(propertyName, performanceStatusesModelInRedis[propertyName]); }); } catch (error) { reject(error); return; } resolve(performanceStatuses); }); }); }); } exports.find = find; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_common.js.html":{"id":"util_common.js.html","title":"Source: util/common.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/common.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * 共通ユーティリティ */ const crypto = require(&quot;crypto&quot;); /** * ミリ秒とプロセスに対してユニークなトークンを生成する * todo uniqidの型定義なし */ function createToken() { // tslint:disable-next-line:no-require-imports const uniqid = require('uniqid'); // tslint:disable-next-line:no-magic-numbers insecure-random const data = (Math.floor(Math.random() * 10000) + 1000).toString() + uniqid(); return crypto.createHash('md5').update(data, 'utf8').digest('hex'); } exports.createToken = createToken; /** * ハッシュ値を作成する */ function createHash(password, salt) { const sha512 = crypto.createHash('sha512'); sha512.update(salt + password, 'utf8'); return sha512.digest('hex'); } exports.createHash = createHash; /** * 全角→半角変換 */ function toHalfWidth(str) { return str.split('').map((value) =&gt; { // 全角であれば変換 // tslint:disable-next-line:no-irregular-whitespace no-magic-numbers return value.replace(/[！-～]/g, String.fromCharCode(value.charCodeAt(0) - 0xFEE0)).replace(' ', ' '); }).join(''); } exports.toHalfWidth = toHalfWidth; /** * 半角→全角変換 */ function toFullWidth(str) { return str.split('').map((value) =&gt; { // 半角であれば変換 // tslint:disable-next-line:no-irregular-whitespace no-magic-numbers return value.replace(/[!-~]/g, String.fromCharCode(value.charCodeAt(0) + 0xFEE0)).replace(' ', ' '); }).join(''); } exports.toFullWidth = toFullWidth; /** * 都道府県リスト */ function getPrefectrues() { return [ { code: '01', name: { ja: '北海道', en: 'Hokkaido Government' } }, { code: '02', name: { ja: '青森県', en: 'Aomori Prefectural Government' } }, { code: '03', name: { ja: '岩手県', en: 'Iwate Prefectural Government' } }, { code: '04', name: { ja: '宮城県', en: 'Miyagi Prefectural Government' } }, { code: '05', name: { ja: '秋田県', en: 'Akita Prefecture' } }, { code: '06', name: { ja: '山形県', en: 'Yamagata Prefecture' } }, { code: '07', name: { ja: '福島県', en: 'Fukushima Prefecture' } }, { code: '08', name: { ja: '茨城県', en: 'Ibaraki Prefecture Government' } }, { code: '09', name: { ja: '栃木県', en: 'Tochigi Prefecture' } }, { code: '10', name: { ja: '群馬県', en: 'Gunma Prefecture' } }, { code: '11', name: { ja: '埼玉県', en: 'Saitama Prefectural Government' } }, { code: '12', name: { ja: '千葉県', en: 'Chiba Prefectural Government' } }, { code: '13', name: { ja: '東京都', en: 'Tokyo Metropolitan Government' } }, { code: '14', name: { ja: '神奈川県', en: 'Kanagawa Prefecture' } }, { code: '15', name: { ja: '新潟県', en: 'Niigata Prefecture' } }, { code: '16', name: { ja: '富山県', en: 'Toyama Prefecture' } }, { code: '17', name: { ja: '石川県', en: 'Ishikawa Prefecture' } }, { code: '18', name: { ja: '福井県', en: 'Fukui Prefectural Government' } }, { code: '19', name: { ja: '山梨県', en: 'Yamanashi Prefecture' } }, { code: '20', name: { ja: '長野県', en: 'Nagano Prefecture' } }, { code: '21', name: { ja: '岐阜県', en: 'Gifu Prefectural Government' } }, { code: '22', name: { ja: '静岡県', en: 'Shizuoka Prefecture' } }, { code: '23', name: { ja: '愛知県', en: 'Aichi Prefecture' } }, { code: '24', name: { ja: '三重県', en: 'Mie Prefecture' } }, { code: '25', name: { ja: '滋賀県', en: 'Shiga Prefecture' } }, { code: '26', name: { ja: '京都府', en: 'Kyoto Prefecture' } }, { code: '27', name: { ja: '大阪府', en: 'Osaka Prefectural Government' } }, { code: '28', name: { ja: '兵庫県', en: 'Hyogo Prefecture' } }, { code: '29', name: { ja: '奈良県', en: 'Nara Prefecture' } }, { code: '30', name: { ja: '和歌山県', en: 'Wakayama Prefecture' } }, { code: '31', name: { ja: '鳥取県', en: 'Tottori Prefecture' } }, { code: '32', name: { ja: '島根県', en: 'Shimane Prefectural Government' } }, { code: '33', name: { ja: '岡山県', en: 'Okayama Prefecture' } }, { code: '34', name: { ja: '広島県', en: 'Hiroshima Prefecture' } }, { code: '35', name: { ja: '山口県', en: 'Yamaguchi Prefecture' } }, { code: '36', name: { ja: '徳島県', en: 'Tokushima Prefecture' } }, { code: '37', name: { ja: '香川県', en: 'Kagawa Prefectural Government' } }, { code: '38', name: { ja: '愛媛県', en: 'Ehime Prefectural Government' } }, { code: '39', name: { ja: '高知県', en: 'Kochi Prefecture' } }, { code: '40', name: { ja: '福岡県', en: 'Fukuoka Prefecture' } }, { code: '41', name: { ja: '佐賀県', en: 'Saga Prefectural Government' } }, { code: '42', name: { ja: '長崎県', en: 'Nagasaki Prefecture' } }, { code: '43', name: { ja: '熊本県', en: 'Kumamoto Prefecture' } }, { code: '44', name: { ja: '大分県', en: 'Oita Prefecture' } }, { code: '45', name: { ja: '宮崎県', en: 'Miyazaki Prefecture' } }, { code: '46', name: { ja: '鹿児島県', en: 'Kagoshima Prefecture' } }, { code: '47', name: { ja: '沖縄県', en: 'Okinawa Prefecture' } } ]; } exports.getPrefectrues = getPrefectrues; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_ticketTypeGroup.js.html":{"id":"util_ticketTypeGroup.js.html","title":"Source: util/ticketTypeGroup.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/ticketTypeGroup.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * 券種ユーティリティ */ const TicketTypeGroupUtil = require(&quot;./ticketTypeGroup&quot;); /** * 券種(一般) */ exports.TICKET_TYPE_CODE_ADULTS = '01'; /** * 券種(学生) */ exports.TICKET_TYPE_CODE_STUDENTS = '02'; /** * 券種(学生当日) */ exports.TICKET_TYPE_CODE_STUDENTS_ON_THE_DAY = '03'; /** * 券種(無料) */ exports.TICKET_TYPE_CODE_FREE = 'FREE'; /** * 券種(Not for sale) */ exports.TICKET_TYPE_CODE_NOT_FOR_SALE = 'NOTFORSALE'; /** * 内部関係者用券種グループを取得する */ function getOne4staff() { return [ { _id: TicketTypeGroupUtil.TICKET_TYPE_CODE_NOT_FOR_SALE, name: { ja: 'Not for sale', en: 'Not for Sale' }, charge: 0 // 料金 }, { _id: TicketTypeGroupUtil.TICKET_TYPE_CODE_FREE, name: { ja: '無料', en: 'Free' }, charge: 0 // 料金 } ]; } exports.getOne4staff = getOne4staff; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_film.js.html":{"id":"util_film.js.html","title":"Source: util/film.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/film.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); // tslint:disable:max-line-length no-irregular-whitespace /** * 部門リストを取得する */ function getSections() { return [ { code: '01', name: { ja: 'オープニング作品', en: 'Opening' } }, { code: '02', name: { ja: 'クロージング作品', en: 'Closing' } }, { code: '03', name: { ja: '授賞式＋東京グランプリ受賞作品上映', en: 'Tokyo Grand-Prix Winner Screening + Award Ceremony' } }, { code: '04', name: { ja: '特別招待作品', en: 'Special Screening' } }, { code: '05', name: { ja: '特別上映', en: 'Special Program' } }, { code: '06', name: { ja: 'ワールド・フォーカス', en: 'World Focus' } }, { code: '07', name: { ja: 'コンペティション', en: 'Competition' } }, { code: '08', name: { ja: '東京グランプリ受賞作品', en: 'Tokyo Grand-Prix Winner Screening' } }, { code: '09', name: { ja: '観客賞受賞作品', en: 'Audience Award Winner Screening' } }, { code: '10', name: { ja: 'アジアの未来', en: 'Asian Future' } }, { code: '11', name: { ja: '日本映画スプラッシュ', en: 'Japanese Cinema Splash' } }, { code: '12', name: { ja: '国際交流基金アジアセンター presents CROSSCUT ASIA ＃03 カラフル！ インドネシア', en: 'The Japan Foundation Asia Center presents CROSSCUT ASIA #03 COLORFUL INDONESIA' } }, { code: '13', name: { ja: 'アニメーション特集 「映画監督 細田守の世界」', en: 'Special Focus on Japanese Animation: The World of Mamoru Hosoda' } }, { code: '14', name: { ja: 'Japan Now', en: 'Japan Now' } }, { code: '15', name: { ja: 'Japan Now「監督特集 岩井俊二」', en: 'Japan Now Director in Focus: Shunji Iwai' } }, { code: '16', name: { ja: '日本映画クラシックス', en: 'Japanese Classics' } }, { code: '17', name: { ja: 'アジア・オムニバス映画製作シリーズ アジア三面鏡2016：リフレクションズ', en: 'Asian Three-Fold Mirror 2016: Reflections' } }, { code: '18', name: { ja: 'みなと上映会', en: 'Minato Screening' } }, { code: '19', name: { ja: '日本映画監督協会新人賞、上映とシンポジウム', en: 'Directors Guild of Japan New Directors Award Film Screening and Symposium' } }, { code: '20', name: { ja: 'PFF（ぴあフィルムフェスティバル）「PFFアワード2016」グランプリ受賞作品上映', en: '2016 PFF Award-Winner Film Screening' } }, { code: '21', name: { ja: '「SKIPシティ国際Dシネマ映画祭2016」作品上映', en: 'Screening of SKIP CITY INTERNATIONAL D-Cinema FESTIVAL 2016' } }, { code: '22', name: { ja: 'ユース（TIFFティーンズ）', en: 'Youth ( TIFF-Teens)' } }, { code: '23', name: { ja: 'ウルトラマンシリーズ放送開始50年 特別企画：脚本家 金城哲夫', en: '50 years since broadcasting of the ULTRAMAN series Special Program: Scriptwriter Tetsuo Kinjo' } }, { code: '24', name: { ja: 'WOWO映画工房×ジャパンプレミア feat. スター・ウォーズ in 東京国際映画祭', en: 'All night screening presented by WOWOW\\'s &quot;CINEMA STUDIO&quot; featuring Star Wars documentary' } }, { code: '25', name: { ja: '日本映画スプラッシュ・場外乱闘編（アウト・オブ・コンペティション）', en: 'Japanese Cinema Splash Out of Competition' } }, { code: '26', name: { ja: '第６回日本学生映画祭', en: 'The 6th Japan Student Film Festival' } } ]; } exports.getSections = getSections; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_owner.js.html":{"id":"util_owner.js.html","title":"Source: util/owner.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/owner.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * オーナーユーティリティ */ /** * 興行関係者 */ exports.GROUP_STAFF = 'STAFF'; /** * 窓口スタッフ */ exports.GROUP_WINDOW_STAFF = 'WINDOW_STAFF'; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"index.js.html":{"id":"index.js.html","title":"Source: index.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: index.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * index module */ const mongoose = require(&quot;mongoose&quot;); const Models = require(&quot;./model/mongoose&quot;); exports.Models = Models; const PerformanceStatusesModel = require(&quot;./model/performanceStatuses&quot;); exports.PerformanceStatusesModel = PerformanceStatusesModel; const CommonUtil = require(&quot;./util/common&quot;); exports.CommonUtil = CommonUtil; const EmailQueueUtil = require(&quot;./util/emailQueue&quot;); exports.EmailQueueUtil = EmailQueueUtil; const FilmUtil = require(&quot;./util/film&quot;); exports.FilmUtil = FilmUtil; const GMONotificationUtil = require(&quot;./util/gmoNotification&quot;); exports.GMONotificationUtil = GMONotificationUtil; const OwnerUtil = require(&quot;./util/owner&quot;); exports.OwnerUtil = OwnerUtil; const PerformanceUtil = require(&quot;./util/performance&quot;); exports.PerformanceUtil = PerformanceUtil; const ReservationUtil = require(&quot;./util/reservation&quot;); exports.ReservationUtil = ReservationUtil; const ScreenUtil = require(&quot;./util/screen&quot;); exports.ScreenUtil = ScreenUtil; const TicketTypeGroupUtil = require(&quot;./util/ticketTypeGroup&quot;); exports.TicketTypeGroupUtil = TicketTypeGroupUtil; /** * MongoDBクライアント`mongoose` * @example * const promise = domain.mongoose.connect('mongodb://localhost/myapp', { * useMongoClient: true * }); */ exports.mongoose = mongoose; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_gmoNotification.js.html":{"id":"util_gmoNotification.js.html","title":"Source: util/gmoNotification.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/gmoNotification.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * GMO通知ユーティリティ */ /** * 未処理 */ exports.PROCESS_STATUS_UNPROCESSED = 'UNPROCESSED'; /** * 処理中 */ exports.PROCESS_STATUS_PROCESSING = 'PROCESSING'; /** * 処理済 */ exports.PROCESS_STATUS_PROCESSED = 'PROCESSED'; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_film.js.html":{"id":"model_mongoose_film.js.html","title":"Source: model/mongoose/film.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/film.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 作品スキーマ */ const schema = new mongoose.Schema({ _id: String, name: { type: multilingualString_1.default, required: true }, description: multilingualString_1.default, notes: multilingualString_1.default, sections: [ { _id: false, code: String, name: multilingualString_1.default } ], minutes: Number, is_mx4d: Boolean, copyright: String, rating: String, sales_release_date: String, sales_end_date: String // 販売終了日時(yyyymmdd) }, { collection: 'films', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('Film', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_theater.js.html":{"id":"model_mongoose_theater.js.html","title":"Source: model/mongoose/theater.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/theater.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 劇場スキーマ */ const schema = new mongoose.Schema({ _id: String, name: multilingualString_1.default, description: multilingualString_1.default, notes: multilingualString_1.default, address: multilingualString_1.default }, { collection: 'theaters', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('Theater', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_sendGridEventNotification.js.html":{"id":"model_mongoose_sendGridEventNotification.js.html","title":"Source: model/mongoose/sendGridEventNotification.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/sendGridEventNotification.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * SendGridイベント通知スキーマ */ const schema = new mongoose.Schema({ payment_no: String, status: String, sg_event_id: String, sg_message_id: String, event: String, email: String, timestamp: Number, 'smtp-id': String, category: [String], asm_group_id: Number, reason: String, type: String, ip: String, tls: String, cert_err: String, useragent: String, url: String, url_offset: { type: { _id: false, index: Number, type: String } }, response: String, send_at: Number }, { collection: 'sendgrid_event_notifications', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('SendGridEventNotification', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_authentication.js.html":{"id":"model_mongoose_authentication.js.html","title":"Source: model/mongoose/authentication.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/authentication.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const owner_1 = require(&quot;./owner&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * ログイン認証スキーマ */ const schema = new mongoose.Schema({ token: { type: String, required: true }, owner: { type: mongoose.Schema.Types.ObjectId, ref: owner_1.default.modelName }, signature: String, locale: String // 使用言語 }, { collection: 'authentications', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('Authentication', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_ticketTypeGroup.js.html":{"id":"model_mongoose_ticketTypeGroup.js.html","title":"Source: model/mongoose/ticketTypeGroup.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/ticketTypeGroup.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const ticketType_1 = require(&quot;./ticketType&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 券種グループスキーマ */ const schema = new mongoose.Schema({ _id: String, name: multilingualString_1.default, ticket_types: [{ type: String, ref: ticketType_1.default.modelName, required: true }] }, { collection: 'ticket_type_groups', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('TicketTypeGroup', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_reservation.js.html":{"id":"model_mongoose_reservation.js.html","title":"Source: model/mongoose/reservation.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/reservation.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); // tslint:disable:no-invalid-this no-magic-numbers space-before-function-paren const moment = require(&quot;moment&quot;); const mongoose = require(&quot;mongoose&quot;); const numeral = require(&quot;numeral&quot;); const film_1 = require(&quot;./film&quot;); const owner_1 = require(&quot;./owner&quot;); const performance_1 = require(&quot;./performance&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const screen_1 = require(&quot;./screen&quot;); const theater_1 = require(&quot;./theater&quot;); const ReservationUtil = require(&quot;../../util/reservation&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 予約スキーマ */ const schema = new mongoose.Schema({ performance: { type: String, ref: performance_1.default.modelName, required: true }, seat_code: { type: String, required: true }, status: { type: String, required: true }, expired_at: Date, performance_day: String, performance_open_time: String, performance_start_time: String, performance_end_time: String, performance_canceled: { type: Boolean, default: false }, theater: { type: String, ref: theater_1.default.modelName }, theater_name: multilingualString_1.default, theater_address: multilingualString_1.default, screen: { type: String, ref: screen_1.default.modelName }, screen_name: multilingualString_1.default, film: { type: String, ref: film_1.default.modelName }, film_name: multilingualString_1.default, film_image: String, film_is_mx4d: Boolean, film_copyright: String, film_rating: String, film_sales_release_date: String, film_sales_end_date: String, purchaser_group: String, purchaser_last_name: String, purchaser_first_name: String, purchaser_email: String, purchaser_tel: String, purchaser_age: String, purchaser_address: String, purchaser_gender: String, payment_no: String, payment_seat_index: Number, purchased_at: Date, payment_method: String, seat_grade_name: multilingualString_1.default, seat_grade_additional_charge: Number, ticket_type: String, ticket_type_name: multilingualString_1.default, ticket_type_charge: Number, watcher_name: String, watcher_name_updated_at: Date, charge: Number, owner: { type: mongoose.Schema.Types.ObjectId, ref: owner_1.default.modelName }, owner_username: String, owner_name: multilingualString_1.default, owner_email: String, owner_group: String, owner_signature: String, checkins: { type: [{ _id: false, when: Date, where: String, why: String, how: String // どうやって }], default: [] }, gmo_order_id: String, // GMO実売上に必要な情報 gmo_shop_id: String, gmo_shop_pass: String, gmo_amount: String, gmo_access_id: String, gmo_access_pass: String, gmo_status: String, // GMO決済開始(リンク決済)時に送信するチェック文字列 gmo_shop_pass_string: String, // 以下、GMO結果通知受信時に情報追加される gmo_tax: String, gmo_forward: String, gmo_method: String, gmo_approve: String, gmo_tran_id: String, gmo_tran_date: String, gmo_pay_type: String, gmo_cvs_code: String, gmo_cvs_conf_no: String, gmo_cvs_receipt_no: String, gmo_cvs_receipt_url: String, gmo_payment_term: String, created_user: String, updated_user: String // todo 不要なので削除 }, { collection: 'reservations', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); // 入場済みかどうかは、履歴があるかどうかで判断 schema.virtual('checked_in').get(function () { return (this.checkins.length &gt; 0); }); // 開始文字列を表示形式で取得できるように schema.virtual('performance_start_str').get(function () { if (this.performance_day === undefined || this.performance_open_time === undefined || this.performance_start_time === undefined) { return {}; } // tslint:disable-next-line:max-line-length const date = `${moment(`${this.performance_day.substr(0, 4)}-${this.performance_day.substr(4, 2)}-${this.performance_day.substr(6)}T00:00:00+09:00`).format('MMMM DD, YYYY')}`; const en = `Open: ${this.performance_open_time.substr(0, 2)}:${this.performance_open_time.substr(2)}/` + `Start: ${this.performance_start_time.substr(0, 2)}:${this.performance_start_time.substr(2)} on ${date}`; const ja = `${this.performance_day.substr(0, 4)}/${this.performance_day.substr(4, 2)}/${this.performance_day.substr(6)} ` + // tslint:disable-next-line:max-line-length `開場 ${this.performance_open_time.substr(0, 2)}:${this.performance_open_time.substr(2)} 開演 ${this.performance_start_time.substr(0, 2)}:${this.performance_start_time.substr(2)}`; return { en: en, ja: ja }; }); schema.virtual('location_str').get(function () { const en = `at ${this.get('screen_name').en}, ${this.get('theater_name').en}`; const ja = `${this.get('theater_name').ja} ${this.get('screen_name').ja}`; return { en: en, ja: ja }; }); schema.virtual('baloon_content4staff').get(function () { let str = `${this.seat_code}`; str += (this.purchaser_group_str !== undefined) ? `&lt;br&gt;${this.purchaser_group_str}` : ''; str += (this.purchaser_name.ja !== undefined) ? `&lt;br&gt;${this.purchaser_name.ja}` : ''; str += (this.watcher_name !== undefined) ? `&lt;br&gt;${this.watcher_name}` : ''; str += (this.status_str !== undefined) ? `&lt;br&gt;${this.status_str}` : ''; return str; }); schema.virtual('purchaser_name').get(function () { let en = ''; if (this.get('status') === ReservationUtil.STATUS_WAITING_SETTLEMENT || this.get('status') === ReservationUtil.STATUS_RESERVED) { switch (this.purchaser_group) { case ReservationUtil.PURCHASER_GROUP_STAFF: en = `${this.get('owner_name').en} ${this.get('owner_signature')}`; break; default: en = `${this.get('purchaser_first_name')} ${this.get('purchaser_last_name')}`; } } let ja = ''; if (this.get('status') === ReservationUtil.STATUS_WAITING_SETTLEMENT || this.get('status') === ReservationUtil.STATUS_RESERVED) { switch (this.purchaser_group) { case ReservationUtil.PURCHASER_GROUP_STAFF: ja = `${this.get('owner_name').ja} ${this.get('owner_signature')}`; break; default: ja = `${this.get('purchaser_last_name')} ${this.get('purchaser_first_name')}`; } } return { en: en, ja: ja }; }); schema.virtual('purchaser_group_str').get(function () { let str = ''; switch (this.get('purchaser_group')) { case ReservationUtil.PURCHASER_GROUP_CUSTOMER: str = '一般'; break; case ReservationUtil.PURCHASER_GROUP_MEMBER: str = 'メルマガ先行会員'; break; case ReservationUtil.PURCHASER_GROUP_STAFF: str = '内部関係者'; break; case ReservationUtil.PURCHASER_GROUP_WINDOW: str = '当日窓口'; break; default: } return str; }); schema.virtual('status_str').get(function () { let str = ''; switch (this.get('status')) { case ReservationUtil.STATUS_RESERVED: str = '予約済'; break; case ReservationUtil.STATUS_TEMPORARY: case ReservationUtil.STATUS_TEMPORARY_ON_KEPT_BY_CHEVRE: str = '仮予約中'; break; case ReservationUtil.STATUS_WAITING_SETTLEMENT: case ReservationUtil.STATUS_WAITING_SETTLEMENT_PAY_DESIGN: str = '決済中'; break; case ReservationUtil.STATUS_KEPT_BY_CHEVRE: str = 'CHEVRE確保中'; break; case ReservationUtil.STATUS_KEPT_BY_MEMBER: str = 'メルマガ保留中'; break; default: } return str; }); /** * QRコード文字列 * 上映日-購入番号-購入座席インデックス * 購入は上映日+購入番号で一意となるので注意すること */ schema.virtual('qr_str').get(function () { return `${this.performance_day}-${this.payment_no}-${this.payment_seat_index}`; }); /** * 券種金額文字列 */ schema.virtual('ticket_type_detail_str').get(function () { let charge = 0; switch (this.get('purchaser_group')) { case ReservationUtil.PURCHASER_GROUP_STAFF: charge += this.get('ticket_type_charge'); break; default: charge += this.get('ticket_type_charge') + this.get('seat_grade_additional_charge') + ((this.get('film_is_mx4d')) ? ReservationUtil.CHARGE_MX4D : 0); } let en = this.get('ticket_type_name').en; switch (this.get('purchaser_group')) { case ReservationUtil.PURCHASER_GROUP_STAFF: if (charge &gt; 0) { en += ` / \\\\${numeral(charge).format('0,0')}`; } break; default: if (charge &gt; 0) { en += ` / \\\\${numeral(charge).format('0,0')}(including tax)`; if (this.get('seat_grade_additional_charge') &gt; 0) { en += ` (including ${this.get('seat_grade_name').en} \\\\` + `${numeral(this.get('seat_grade_additional_charge')).format('0,0')})`; } } } let ja = this.get('ticket_type_name').ja; switch (this.get('purchaser_group')) { case ReservationUtil.PURCHASER_GROUP_STAFF: if (charge &gt; 0) { ja += ` / \\\\${numeral(charge).format('0,0')}`; } break; default: if (charge &gt; 0) { ja += ` / \\\\${numeral(charge).format('0,0')}(税込)`; if (this.get('seat_grade_additional_charge') &gt; 0) { ja += ` (内${this.get('seat_grade_name').ja} \\\\${numeral(this.get('seat_grade_additional_charge')).format('0,0')})`; } } } return { en: en, ja: ja }; }); /** * CHEVRE確保への更新の場合、パフォーマンス情報だけ残して、購入者情報は削除する */ schema.post('findOneAndUpdate', function (err, doc, next) { if (err instanceof Error) { return next(err); } if (doc.get('status') === ReservationUtil.STATUS_KEPT_BY_CHEVRE) { const paths4set = [ '_id', 'performance', 'seat_code', 'status', 'created_at', 'updated_at', 'performance_day', 'performance_open_time', 'performance_start_time', 'performance_end_time', 'performance_canceled', 'theater', 'theater_name', 'theater_address', 'screen', 'screen_name', 'film', 'film_name', 'film_image', 'film_is_mx4d', 'film_copyright', 'film_rating' ]; const unset = {}; this.schema.eachPath((path) =&gt; { if (paths4set.indexOf(path) &lt; 0) { unset[path] = ''; } }); doc.update({ $unset: unset }, // (err, raw) =&gt; { () =&gt; { // 仮に失敗したとしても気にしない }); } }); schema.index({ performance: 1, seat_code: 1 }, { unique: true }); // GMO結果通知処理時なのに、GMOオーダーIDで検索するので schema.index({ gmo_order_id: 1 }); exports.default = mongoose.model('Reservation', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_client.js.html":{"id":"model_mongoose_client.js.html","title":"Source: model/mongoose/client.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/client.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * アプリケーションクライアントスキーマ */ const schema = new mongoose.Schema({ _id: String, secret_salt: { type: String, required: true }, secret_hash: { type: String, required: true }, name: multilingualString_1.default, description: multilingualString_1.default, notes: multilingualString_1.default, email: String }, { collection: 'clients', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('Client', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_customerCancelRequest.js.html":{"id":"model_mongoose_customerCancelRequest.js.html","title":"Source: model/mongoose/customerCancelRequest.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/customerCancelRequest.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 一般キャンセルリクエストスキーマ */ const schema = new mongoose.Schema({ payment_no: { type: String, required: true }, payment_method: { type: String, required: true }, email: { type: String, required: true }, tel: { type: String, required: true } }, { collection: 'customer_cancel_requests', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('CustomerCancelRequest', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_emailQueue.js.html":{"id":"model_mongoose_emailQueue.js.html","title":"Source: model/mongoose/emailQueue.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/emailQueue.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * メール送信キュースキーマ */ const schema = new mongoose.Schema({ from: { address: { type: String, required: true }, name: String }, to: { address: { type: String, required: true }, name: String }, subject: { type: String, required: true }, content: { mimetype: { type: String, required: true }, text: { type: String, required: true } }, status: { type: String, required: true } }, { collection: 'email_queues', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); // 送信ステータスで検索して処理するので schema.index({ status: 1 }); exports.default = mongoose.model('EmailQueue', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_sequence.js.html":{"id":"model_mongoose_sequence.js.html","title":"Source: model/mongoose/sequence.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/sequence.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 採番スキーマ */ const schema = new mongoose.Schema({ target: String, date: String, no: Number // 連番 }, { collection: 'sequences', id: true, read: 'primaryPreferred', // 採番はprimaryとその他で決してデータが重複してはならないので、write concernの設定には要注意 safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); // 日付ごとに対象の採番が重複しないように schema.index({ target: 1, date: 1 }, { unique: true }); exports.default = mongoose.model('Sequence', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_performance.js.html":{"id":"model_mongoose_performance.js.html","title":"Source: model/mongoose/performance.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/performance.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); // tslint:disable:no-invalid-this no-magic-numbers space-before-function-paren const moment = require(&quot;moment&quot;); const mongoose = require(&quot;mongoose&quot;); const PerformanceUtil = require(&quot;../../util/performance&quot;); const film_1 = require(&quot;./film&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const screen_1 = require(&quot;./screen&quot;); const theater_1 = require(&quot;./theater&quot;); const ticketTypeGroup_1 = require(&quot;./ticketTypeGroup&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; const DEFAULT_RADIX = 10; /** * パフォーマンススキーマ */ const schema = new mongoose.Schema({ theater: { type: String, ref: theater_1.default.modelName }, theater_name: multilingualString_1.default, screen: { type: String, ref: screen_1.default.modelName }, screen_name: multilingualString_1.default, film: { type: String, ref: film_1.default.modelName }, ticket_type_group: { type: String, ref: ticketTypeGroup_1.default.modelName }, day: String, open_time: String, start_time: String, end_time: String, canceled: Boolean // 上映中止フラグ }, { collection: 'performances', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); /** * 開始文字列を多言語で取得 */ schema.virtual('start_str').get(function () { // tslint:disable-next-line:max-line-length const date = `${moment(`${this.day.substr(0, 4)}-${this.day.substr(4, 2)}-${this.day.substr(6)}T00:00:00+09:00`).format('MMMM DD, YYYY')}`; // tslint:disable-next-line:max-line-length const en = `Open: ${this.open_time.substr(0, 2)}:${this.open_time.substr(2)}/Start: ${this.start_time.substr(0, 2)}:${this.start_time.substr(2)} on ${date}`; // tslint:disable-next-line:max-line-length const ja = `${this.day.substr(0, 4)}/${this.day.substr(4, 2)}/${this.day.substr(6)} 開場 ${this.open_time.substr(0, 2)}:${this.open_time.substr(2)} 開演 ${this.start_time.substr(0, 2)}:${this.start_time.substr(2)}`; return { en: en, ja: ja }; }); /** * 上映場所文字列を多言語で取得 */ schema.virtual('location_str').get(function () { return { en: `at ${this.get('screen_name').en}, ${this.get('theater_name').en}`, ja: `${this.get('theater_name').ja} ${this.get('screen_name').ja}` }; }); /** * 空席ステータスを算出する * @param reservationNumber 予約数 */ schema.methods.getSeatStatus = function (reservationNumber) { // 上映日当日過ぎていればG if (parseInt(this.day, DEFAULT_RADIX) &lt; parseInt(moment().format('YYYYMMDD'), DEFAULT_RADIX)) { return PerformanceUtil.SEAT_STATUS_G; } // 残席0以下なら問答無用に× const availableSeatNum = this.screen.seats_number - reservationNumber; if (availableSeatNum &lt;= 0) { return PerformanceUtil.SEAT_STATUS_C; } // 残席数よりステータスを算出 const seatNum = availableSeatNum * 100; if (PerformanceUtil.SEAT_STATUS_THRESHOLD_A * this.screen.seats_number &lt; seatNum) { return PerformanceUtil.SEAT_STATUS_A; } if (PerformanceUtil.SEAT_STATUS_THRESHOLD_B * this.screen.seats_number &lt; seatNum) { return PerformanceUtil.SEAT_STATUS_B; } return PerformanceUtil.SEAT_STATUS_C; }; schema.index({ day: 1, start_time: 1 }); exports.default = mongoose.model('Performance', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_gmoNotification.js.html":{"id":"model_mongoose_gmoNotification.js.html","title":"Source: model/mongoose/gmoNotification.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/gmoNotification.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * GMO結果通知スキーマ */ const schema = new mongoose.Schema({ shop_id: String, order_id: String, status: String, job_cd: String, amount: String, pay_type: String, tax: String, access_id: String, forward: String, method: String, approve: String, tran_id: String, tran_date: String, cvs_code: String, cvs_conf_no: String, cvs_receipt_no: String, payment_term: String, process_status: { type: String, required: true } }, { collection: 'gmo_notifications', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); // 処理ステータスで検索して処理するので schema.index({ process_status: 1 }); exports.default = mongoose.model('GMONotification', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_ticketType.js.html":{"id":"model_mongoose_ticketType.js.html","title":"Source: model/mongoose/ticketType.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/ticketType.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * 券種スキーマ */ const schema = new mongoose.Schema({ _id: String, name: multilingualString_1.default, description: multilingualString_1.default, notes: multilingualString_1.default, charge: Number // 料金 }, { collection: 'ticket_types', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('TicketType', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_owner.js.html":{"id":"model_mongoose_owner.js.html","title":"Source: model/mongoose/owner.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/owner.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * リソースオーナースキーマ */ const schema = new mongoose.Schema({ username: { type: String, unique: true }, password_salt: { type: String, required: true }, password_hash: { type: String, required: true }, name: multilingualString_1.default, description: multilingualString_1.default, notes: multilingualString_1.default, email: String, group: { type: String, required: true } }, { collection: 'owners', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); schema.index({ username: 1 }, { unique: true }); exports.default = mongoose.model('Owner', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"model_mongoose_screen.js.html":{"id":"model_mongoose_screen.js.html","title":"Source: model/mongoose/screen.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: model/mongoose/screen.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const mongoose = require(&quot;mongoose&quot;); const multilingualString_1 = require(&quot;./schemaTypes/multilingualString&quot;); const theater_1 = require(&quot;./theater&quot;); const safe = { j: 1, w: 'majority', wtimeout: 10000 }; /** * スクリーンスキーマ */ const schema = new mongoose.Schema({ _id: String, theater: { type: String, ref: theater_1.default.modelName }, name: multilingualString_1.default, description: multilingualString_1.default, notes: multilingualString_1.default, seats_number: Number, seats_numbers_by_seat_grade: [{ _id: false, seat_grade_code: String, seats_number: Number }], sections: [ { _id: false, code: String, name: multilingualString_1.default, seats: [ { _id: false, code: String, grade: { code: String, name: multilingualString_1.default, additional_charge: Number // 追加料金 } } ] } ] }, { collection: 'screens', id: true, read: 'primaryPreferred', safe: safe, timestamps: { createdAt: 'created_at', updatedAt: 'updated_at' }, toJSON: { getters: true }, toObject: { getters: true } }); exports.default = mongoose.model('Screen', schema); × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_screen.js.html":{"id":"util_screen.js.html","title":"Source: util/screen.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/screen.js &quot;use strict&quot;; /** * スクリーンユーティリティ */ Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); const DEFAULT_RADIX = 10; /** * ノーマルシート */ exports.SEAT_GRADE_CODE_NORMAL = '00'; /** * プレミアボックスシート */ exports.SEAT_GRADE_CODE_PREMIERE_BOX = '01'; /** * プレミアラグジュアリーシート */ exports.SEAT_GRADE_CODE_PREMIERE_LUXURY = '02'; /** * フロントリクライニングシート */ exports.SEAT_GRADE_CODE_FRONT_RECLINING = '03'; /** * 座席コードのソート関数 * @param a 座席コード * @param b 座席コード */ function sortBySeatCode(a, b) { const hyphenIndexA = a.lastIndexOf('-'); const hyphenIndexB = b.lastIndexOf('-'); const rowA = a.substr(0, hyphenIndexA); // 行 const rowB = b.substr(0, hyphenIndexB); // 行 const columnA = a.substr(hyphenIndexA + 1); // 列 const columnB = b.substr(hyphenIndexB + 1); // 列 if (rowA &lt; rowB) { return -1; // 行は文字列比較 } else if (rowA &gt; rowB) { return 1; // 行は文字列比較 } else if (parseInt(columnA, DEFAULT_RADIX) &lt; parseInt(columnB, DEFAULT_RADIX)) { return -1; // 列は数値比較 } return 1; } exports.sortBySeatCode = sortBySeatCode; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_performance.js.html":{"id":"util_performance.js.html","title":"Source: util/performance.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/performance.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * パフォーマンスユーティリティ */ /** * 座席ステータス(◎) */ exports.SEAT_STATUS_A = '◎'; /** * 座席ステータス(△) */ exports.SEAT_STATUS_B = '△'; /** * 座席ステータス(×) */ exports.SEAT_STATUS_C = '×'; /** * 座席ステータス(販売期間外) */ exports.SEAT_STATUS_G = '-'; /** * 座席ステータス閾値(◎) */ exports.SEAT_STATUS_THRESHOLD_A = 30; /** * 座席ステータス閾値(△) */ exports.SEAT_STATUS_THRESHOLD_B = 0; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"util_emailQueue.js.html":{"id":"util_emailQueue.js.html","title":"Source: util/emailQueue.js","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Source: util/emailQueue.js &quot;use strict&quot;; Object.defineProperty(exports, &quot;__esModule&quot;, { value: true }); /** * メールキューユーティリティ */ /** * 未送信 */ exports.STATUS_UNSENT = 'UNSENT'; /** * 送信中 */ exports.STATUS_SENDING = 'SENDING'; /** * 送信済 */ exports.STATUS_SENT = 'SENT'; × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"global.html":{"id":"global.html","title":"Global","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Global Members CHARGE_CVS コンビニ決済手数料 Source: util/reservation.js, line 72 CHARGE_MX4D MX4D追加料金 Source: util/reservation.js, line 68 &lt;constant&gt; createDebug 座席予約ユーティリティ Source: util/reservation.js, line 15 &lt;constant&gt; crypto 共通ユーティリティ Source: util/common.js, line 6 GROUP_STAFF 興行関係者 Source: util/owner.js, line 9 GROUP_WINDOW_STAFF 窓口スタッフ Source: util/owner.js, line 13 &lt;constant&gt; mongoose index module Source: index.js, line 6 mongoose MongoDBクライアントmongoose Source: index.js, line 36 Example const promise = domain.mongoose.connect('mongodb://localhost/myapp', { useMongoClient: true }); PROCESS_STATUS_PROCESSED 処理済 Source: util/gmoNotification.js, line 17 PROCESS_STATUS_PROCESSING 処理中 Source: util/gmoNotification.js, line 13 PROCESS_STATUS_UNPROCESSED 未処理 Source: util/gmoNotification.js, line 9 PURCHASER_GROUP_CUSTOMER 一般 Source: util/reservation.js, line 52 PURCHASER_GROUP_MEMBER メルマガ会員先行 Source: util/reservation.js, line 56 PURCHASER_GROUP_STAFF 内部関係者 Source: util/reservation.js, line 60 PURCHASER_GROUP_WINDOW 窓口 Source: util/reservation.js, line 64 &lt;constant&gt; redis パフォーマンス情報モデル Source: model/performanceStatuses.js, line 14 &lt;constant&gt; schema 作品スキーマ Source: model/mongoose/film.js, line 9 &lt;constant&gt; schema 劇場スキーマ Source: model/mongoose/theater.js, line 9 &lt;constant&gt; schema SendGridイベント通知スキーマ Source: model/mongoose/sendGridEventNotification.js, line 8 &lt;constant&gt; schema ログイン認証スキーマ Source: model/mongoose/authentication.js, line 9 &lt;constant&gt; schema 券種グループスキーマ Source: model/mongoose/ticketTypeGroup.js, line 10 &lt;constant&gt; schema 予約スキーマ Source: model/mongoose/reservation.js, line 18 &lt;constant&gt; schema アプリケーションクライアントスキーマ Source: model/mongoose/client.js, line 9 &lt;constant&gt; schema 一般キャンセルリクエストスキーマ Source: model/mongoose/customerCancelRequest.js, line 8 &lt;constant&gt; schema メール送信キュースキーマ Source: model/mongoose/emailQueue.js, line 8 &lt;constant&gt; schema 採番スキーマ Source: model/mongoose/sequence.js, line 8 &lt;constant&gt; schema パフォーマンススキーマ Source: model/mongoose/performance.js, line 17 &lt;constant&gt; schema GMO結果通知スキーマ Source: model/mongoose/gmoNotification.js, line 8 &lt;constant&gt; schema 券種スキーマ Source: model/mongoose/ticketType.js, line 9 &lt;constant&gt; schema リソースオーナースキーマ Source: model/mongoose/owner.js, line 9 &lt;constant&gt; schema スクリーンスキーマ Source: model/mongoose/screen.js, line 10 SEAT_GRADE_CODE_FRONT_RECLINING フロントリクライニングシート Source: util/screen.js, line 22 SEAT_GRADE_CODE_NORMAL ノーマルシート Source: util/screen.js, line 10 SEAT_GRADE_CODE_PREMIERE_BOX プレミアボックスシート Source: util/screen.js, line 14 SEAT_GRADE_CODE_PREMIERE_LUXURY プレミアラグジュアリーシート Source: util/screen.js, line 18 SEAT_STATUS_A 座席ステータス(◎) Source: util/performance.js, line 9 SEAT_STATUS_B 座席ステータス(△) Source: util/performance.js, line 13 SEAT_STATUS_C 座席ステータス(×) Source: util/performance.js, line 17 SEAT_STATUS_G 座席ステータス(販売期間外) Source: util/performance.js, line 21 SEAT_STATUS_THRESHOLD_A 座席ステータス閾値(◎) Source: util/performance.js, line 25 SEAT_STATUS_THRESHOLD_B 座席ステータス閾値(△) Source: util/performance.js, line 29 SEQUENCE_TARGET 採番対象名 Source: util/reservation.js, line 89 STATUS_KEPT_BY_CHEVRE CHEVRE確保 Source: util/reservation.js, line 40 STATUS_KEPT_BY_MEMBER メルマガ会員保留 Source: util/reservation.js, line 44 STATUS_RESERVED 予約確定 Source: util/reservation.js, line 48 STATUS_SENDING 送信中 Source: util/emailQueue.js, line 13 STATUS_SENT 送信済 Source: util/emailQueue.js, line 17 STATUS_TEMPORARY 仮予約 Source: util/reservation.js, line 24 STATUS_TEMPORARY_ON_KEPT_BY_CHEVRE CHEVRE確保上の仮予約 Source: util/reservation.js, line 28 STATUS_UNSENT 未送信 Source: util/emailQueue.js, line 9 STATUS_WAITING_SETTLEMENT 決済待ち Source: util/reservation.js, line 32 STATUS_WAITING_SETTLEMENT_PAY_DESIGN ペイデザイン決済待ち Source: util/reservation.js, line 36 TICKET_TYPE_CODE_ADULTS 券種(一般) Source: util/ticketTypeGroup.js, line 10 TICKET_TYPE_CODE_FREE 券種(無料) Source: util/ticketTypeGroup.js, line 22 TICKET_TYPE_CODE_NOT_FOR_SALE 券種(Not for sale) Source: util/ticketTypeGroup.js, line 26 TICKET_TYPE_CODE_STUDENTS 券種(学生) Source: util/ticketTypeGroup.js, line 14 TICKET_TYPE_CODE_STUDENTS_ON_THE_DAY 券種(学生当日) Source: util/ticketTypeGroup.js, line 18 &lt;constant&gt; TicketTypeGroupUtil 券種ユーティリティ Source: util/ticketTypeGroup.js, line 6 Methods create() パフォーマンス情報を新規作成する Source: model/performanceStatuses.js, line 56 createGMOOrderId(performanceDay, paymentNo, serialNumber) GMOオーダーIDを生成する Parameters: Name Type Description performanceDay パフォーマンス上映日(8桁) paymentNo 購入番号(9桁) serialNumber 連番(2桁) Source: util/reservation.js, line 196 createHash() ハッシュ値を作成する Source: util/common.js, line 22 createToken() ミリ秒とプロセスに対してユニークなトークンを生成するtodo uniqidの型定義なし Source: util/common.js, line 11 decodePaymentNo(paymentNo) 購入番号をデコードする Parameters: Name Type Description paymentNo 購入番号 Source: util/reservation.js, line 180 Returns: 連番 find() ストレージから検索する Source: model/performanceStatuses.js, line 81 getCheckDigit() チェックディジットを求める Source: util/reservation.js, line 133 getCheckDigit2() チェックディジットを求める2 Source: util/reservation.js, line 149 getOne4staff() 内部関係者用券種グループを取得する Source: util/ticketTypeGroup.js, line 30 getPrefectrues() 都道府県リスト Source: util/common.js, line 53 getSections() 部門リストを取得する Source: util/film.js, line 7 isValidPaymentNo() 購入番号の有効性をチェックする Source: util/reservation.js, line 163 pad(input, length, padString) 頭を指定文字列で埋める Parameters: Name Type Description input 元の文字列 length 最終的な文字列の長さ padString 埋める文字列 Source: util/reservation.js, line 127 Returns: 結果文字列 parseGMOOrderId(orderId) GMOオーダーIDをパースする Parameters: Name Type Description orderId オーダーID Source: util/reservation.js, line 205 publishPaymentNo() 購入管理番号生成 Source: util/reservation.js, line 94 sortBySeatCode(a, b) 座席コードのソート関数 Parameters: Name Type Description a 座席コード b 座席コード Source: util/screen.js, line 28 store() ストレージに保管する Source: model/performanceStatuses.js, line 63 toFullWidth() 半角→全角変換 Source: util/common.js, line 42 toHalfWidth() 全角→半角変換 Source: util/common.js, line 31 × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Classes Classes PerformanceStatuses × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Chevre Domain Library for Node.js 元祖興行パッケージオンラインチケットシステムのドメインモデルをnode.jsで使いやすいようにまとめたパッケージです。 Table of contents Usage Code Samples License Usagenpm install --save @chevre/domainconst chevre = require(&quot;@chevre/chevredomain&quot;);前提として、mongooseでdefault connectionを確保することと、redis情報をセットすることが必要。 mongoose default connection chevre.mongoose.connect();Environment variables Name Required Value Purpose DEBUG false chevre-domain:* Debug CHEVRE_PERFORMANCE_STATUSES_REDIS_PORT true パフォーマンス空席状況保管RedisCache接続情報 CHEVRE_PERFORMANCE_STATUSES_REDIS_HOST true パフォーマンス空席状況保管RedisCache接続情報 CHEVRE_PERFORMANCE_STATUSES_REDIS_KEY true パフォーマンス空席状況保管RedisCache接続情報 Code SamplesCode sample are here. LicenseISC × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "},"PerformanceStatuses.html":{"id":"PerformanceStatuses.html","title":"Class: PerformanceStatuses","body":" Chevre Domain Library for Node.js Classes PerformanceStatuses Global CHARGE_CVSCHARGE_MX4DcreatecreateDebugcreateGMOOrderIdcreateHashcreateTokencryptodecodePaymentNofindgetCheckDigitgetCheckDigit2getOne4staffgetPrefectruesgetSectionsGROUP_STAFFGROUP_WINDOW_STAFFisValidPaymentNomongoosepadparseGMOOrderIdPROCESS_STATUS_PROCESSEDPROCESS_STATUS_PROCESSINGPROCESS_STATUS_UNPROCESSEDpublishPaymentNoPURCHASER_GROUP_CUSTOMERPURCHASER_GROUP_MEMBERPURCHASER_GROUP_STAFFPURCHASER_GROUP_WINDOWredisschemaSEAT_GRADE_CODE_FRONT_RECLININGSEAT_GRADE_CODE_NORMALSEAT_GRADE_CODE_PREMIERE_BOXSEAT_GRADE_CODE_PREMIERE_LUXURYSEAT_STATUS_ASEAT_STATUS_BSEAT_STATUS_CSEAT_STATUS_GSEAT_STATUS_THRESHOLD_ASEAT_STATUS_THRESHOLD_BSEQUENCE_TARGETsortBySeatCodeSTATUS_KEPT_BY_CHEVRESTATUS_KEPT_BY_MEMBERSTATUS_RESERVEDSTATUS_SENDINGSTATUS_SENTSTATUS_TEMPORARYSTATUS_TEMPORARY_ON_KEPT_BY_CHEVRESTATUS_UNSENTSTATUS_WAITING_SETTLEMENTSTATUS_WAITING_SETTLEMENT_PAY_DESIGNstoreTICKET_TYPE_CODE_ADULTSTICKET_TYPE_CODE_FREETICKET_TYPE_CODE_NOT_FOR_SALETICKET_TYPE_CODE_STUDENTSTICKET_TYPE_CODE_STUDENTS_ON_THE_DAYTicketTypeGroupUtiltoFullWidthtoHalfWidth Class: PerformanceStatuses PerformanceStatuses パフォーマンス情報 new PerformanceStatuses() Source: model/performanceStatuses.js, line 38 Methods getStatus() パフォーマンスIDから空席ステータスを取得する Source: model/performanceStatuses.js, line 42 setStatus() パフォーマンスIDの空席ステータスをセットする Source: model/performanceStatuses.js, line 48 × Search results Close Documentation generated by JSDoc 3.5.5 on Mon Aug 6th 2018 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
